import psycopg2
from faker import Faker
import random
from datetime import datetime, timedelta

# Database connection configuration
database_config = {
    'dbname': 'your_dbname',
    'user': 'your_username',
    'password': 'your_password',
    'host': 'your_host',
    'port': 'your_port'
}

# Number of rows of junk data to insert
num_rows = 100

# Establish a database connection
conn = psycopg2.connect(
    dbname=database_config['dbname'],
    user=database_config['user'],
    password=database_config['password'],
    host=database_config['host'],
    port=database_config['port']
)
cursor = conn.cursor()

# Create an instance of Faker
fake = Faker()

# Function to generate a random float value
def random_float():
    return round(random.uniform(1.0, 100.0), 2)

# Insert junk data into the table
for _ in range(num_rows):
    # Generate random timestamps with the required conditions
    edd = fake.date_time_this_year()
    eda = edd + timedelta(days=random.randint(1, 10))
    rdd = edd + timedelta(days=random.randint(1, 10))
    ETA_to_APOE = fake.date_time_this_year()
    Delivery_Window = ETA_to_APOE + timedelta(hours=random.randint(1, 48))
    
    query = """
    INSERT INTO YourTableName (
        pda, rcn, status, comments, startLocation, endLocation,
        edd, rdd, eda, SAMM_Details, TCN, NSN, nomenclature,
        QTY, DODIC, ST, Depot, APOE, Bol, SDT_Cost, Carrier,
        ETA_to_APOE, Delivery_Window, Truck_status, SAAM_Status
    ) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
    """
    values = (
        fake.word(), fake.word(), fake.word(), fake.sentence(),
        fake.city(), fake.city(), edd, rdd, eda, fake.sentence(),
        fake.bothify(text='??####???????????'), fake.bothify(text='########?????'),
        fake.word(), random.randint(1, 100), fake.word(), random_float(),
        fake.word(), fake.word(), fake.bothify(text='########?????'),
        random.uniform(10.0, 500.0), fake.company(), ETA_to_APOE,
        Delivery_Window, fake.word(), fake.word()
    )
    cursor.execute(query, values)

# Commit the transaction
conn.commit()

# Close the cursor and connection
cursor.close()
conn.close()

print("Junk data inserted successfully")
